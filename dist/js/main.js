import sliders from"./sliders.js";import Popup from"./popup.js";import range from"./range.js";import checkPasswordQuality from"./check-password-quality.js";const body=document.querySelector("body"),html=document.querySelector("html"),menu=document.querySelectorAll(".header__burger, .header__nav, body"),header=document.querySelector(".header"),imageAspectRatio=document.querySelectorAll(".image-aspect-ratio, figure img");imageAspectRatio.forEach(e=>{e.getAttribute("width")&&e.getAttribute("height")&&e.style.setProperty("--aspect-ratio",`${e.getAttribute("width")}/${e.getAttribute("height")}`)});const popup=new Popup;popup.init();const getDeviceType=()=>{const e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"mobile":"desktop"};body.addEventListener("click",(function(e){function t(t){return e.target.closest(t)}t(".header__burger")&&menu.forEach(e=>{e.classList.toggle("is-mobile-menu-active")});const s=t(".header__nav-list > li > a");s?"desktop"!=getDeviceType()&&s.parentElement.querySelector("ul")&&(s.classList.contains("is-active")||(e.preventDefault(),s.classList.add("is-active"))):t(".header__nav-list > li")||document.querySelectorAll(".header__nav-list > li > a.is-active").forEach(e=>e.classList.remove("is-active"));const i=t(".header__search-target");i?i.classList.toggle("is-active"):t(".header__search")||document.querySelectorAll(".header__search-target.is-active").forEach(e=>e.classList.remove("is-active"));const c=t(".header__drop-down-target");c?c.classList.contains("is-active")?document.querySelectorAll(".header__drop-down-target.is-active").forEach(e=>e.classList.remove("is-active")):(document.querySelectorAll(".header__drop-down-target.is-active").forEach(e=>e.classList.remove("is-active")),c.classList.add("is-active")):t(".header__drop-down")||document.querySelectorAll(".header__drop-down-target.is-active").forEach(e=>e.classList.remove("is-active"));const o=t(".product__favorite");o&&(e.preventDefault(),o.classList.toggle("is-active"),o.classList.contains("is-active")&&popup.open("#favorites-popup"));const a=t(".product__description-more");a&&a.closest(".product__description").classList.add("is-full");const r=t(".reviews__tab-link");if(r&&(e.preventDefault(),!r.classList.contains("is-active"))){const e=r.closest(".reviews"),t=e.querySelector(".reviews__block.is-active"),s=e.querySelector(".reviews__tab-link.is-active"),i=e.querySelector(r.getAttribute("href"));i&&!e.classList.contains("in-processing")&&(e.classList.add("in-processing"),s&&s.classList.remove("is-active"),r.classList.add("is-active"),t?(t.classList.remove("is-visible"),setTimeout(()=>{t.classList.remove("is-active"),i.classList.add("is-active"),setTimeout(()=>{i.classList.add("is-visible"),e.classList.remove("in-processing")},50)},400)):(i.classList.add("is-active"),setTimeout(()=>{i.classList.add("is-visible"),e.classList.remove("in-processing")},50)))}const l=t(".cart-item__remove");if(l){const e=l.closest(".cart-item");e.classList.contains("is-removing")||(e.classList.add("is-removing"),setTimeout(()=>e.remove(),450))}if(t(".products__filter-open")){const e=document.querySelector(".products__aside");e.classList.contains("in-processing")||(e.classList.add("is-active"),body.classList.add("is-mobile-menu-active"),setTimeout(()=>{e.classList.add("is-visible")},50),setTimeout(()=>{e.classList.remove("in-processing")},450))}if(t(".products__aside-close, .products__aside-background, .products__aside-results")){const e=document.querySelector(".products__aside");e.classList.contains("in-processing")||(e.classList.remove("is-visible"),setTimeout(()=>{e.classList.remove("is-active"),body.classList.remove("is-mobile-menu-active")},450))}const n=t(".account__nav > ul > li > a");n?(n.closest("li").querySelector("ul .is-current"),n.classList.contains("is-active")||n.closest("li").querySelector("ul .is-current")||(e.preventDefault(),n.classList.add("is-active"))):t(".account__nav")||document.querySelectorAll(".account__nav > ul > li > a.is-active").forEach(e=>e.classList.remove("is-active"));const d=t(".account-order-item__target");if(d){d.closest(".account-order-item").classList.toggle("is-active")}const u=t(".cart-item__quantity-plus");if(u){const e=u.closest(".cart-item__quantity").querySelector("input"),t=e.max??1;let s=Number(e.value)+1;e.value=s<=t?s:t}const v=t(".cart-item__quantity-minus");if(v){const e=v.closest(".cart-item__quantity").querySelector("input");let t=Number(e.value)-1;e.value=t>=1?t:1}const _=t(".checkout-cart__promo-code-target");_&&_.classList.toggle("is-active");const m=t(".checkout__help");m?"desktop"!=getDeviceType()&&(m.classList.contains("is-active")?m.classList.remove("is-active"):(document.querySelectorAll(".checkout__help.is-active").forEach(e=>e.classList.remove("is-active")),m.classList.add("is-active"))):t(".checkout__help")||document.querySelectorAll(".checkout__help.is-active").forEach(e=>e.classList.remove("is-active"));const p=t(".checkout__comment button");p&&p.classList.toggle("is-active")}));let windowSize=0;function resize(){header&&html.style.setProperty("--height-header",header.offsetHeight+"px"),html.style.setProperty("--vh",(.01*window.innerHeight).toFixed(2)+"px"),windowSize!=window.innerWidth&&html.style.setProperty("--svh",(.01*window.innerHeight).toFixed(2)+"px"),windowSize=window.innerWidth}resize(),window.addEventListener("resize",resize),sliders(),range(),checkPasswordQuality(),document.querySelectorAll(".product__about").forEach(e=>{e.addEventListener("submit",e=>{e.preventDefault(),popup.open("#cart-popup")})}),document.querySelectorAll(".account__nav > ul > li").forEach(e=>{e.querySelector("ul .is-current")&&e.classList.add("has-current-sub")}),document.querySelectorAll(".checkout__radio input").forEach(e=>{const t=e.closest(".checkout__fieldset").querySelectorAll(".checkout__block");if(e.checked){e.closest(".checkout__block").classList.add("is-active")}e.addEventListener("change",()=>{const s=e.closest(".checkout__block");t.forEach(e=>{e.classList.remove("is-active")}),s.classList.add("is-active")})}),AOS.init({disable:"mobile",once:!0});